<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Gramagem e Peso Linear</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <style>
body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .logo {
      max-width: 120px;
      height: auto;
      margin-bottom: 10px;
    }

    .header h1 {
      margin: 0;
      font-size: 2em;
      color: #333;
    }

    .header p {
      font-size: 1em;
      color: #666;
    }

    .container {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      margin: 0 auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }

    input[type="number"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      box-sizing: border-box;
    }

    button {
      margin-top: 20px;
      padding: 10px 15px;
      background-color: #0078D7;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #005a9e;
    }

    .resultado {
      margin-top: 20px;
      font-size: 1.2em;
      color: #333;
    }

  </style>
  
</head>

<body>
<div class="header">
  <img src="data:image/jpeg;base64,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" alt="Logo ou imagem" class="logo">
 
</div>

  <div class="container">
    <h1>Calculadora de Gramagem e Peso Linear</h1>

    <label for="tipoCalculo">Tipo de C√°lculo:</label>
    <select id="tipoCalculo" onchange="mostrarCampos()">
      <option value="algodao">Algod√£o</option>
      <option value="linho">Linho</option>
      <option value="ambos">Ambos</option>
    </select>

    <label>Nome do Projeto:
      <input type="text" id="nomeProjeto" placeholder="Ex: Tecidos Ver√£o 2025" style="width: 300px;">
    </label>

    <!-- üîµ Algod√£o -->
    <div id="algodaoCampos">
      <h2>Algod√£o (Ne)</h2>
      <label>Fios Teia: <input type="number" id="fiosTeiaCO" value="110"></label>
      <label>Fios Trama: <input type="number" id="fiosTramaCO" value="90"></label>
      <label>Ne Teia (ex: 20 ou 26/2): <input type="text" id="neTeiaCO" value="40"></label>
      <label>Ne Trama (ex: 15 ou 30/2): <input type="text" id="neTramaCO" value="40"></label>
      <label>Encolhimento Teia (%): <input type="number" id="encTeiaCO" value="5"></label>
      <label>Encolhimento Trama (%): <input type="number" id="encTramaCO" value="3"></label>
      <label>Largura da Tela (cm): <input type="number" id="larguraCO" value="315"></label>
    </div>

    <!-- üü¢ Linho -->
    <div id="linhoCampos">
      <h2>Linho (Nm)</h2>
      <label>Fios Teia: <input type="number" id="fiosTeiaLI" value="50"></label>
      <label>Fios Trama: <input type="number" id="fiosTramaLI" value="48"></label>
      <label>Nm Teia (ex: 7 ou 26/2): <input type="text" id="nmTeiaLI" value="26"></label>
      <label>Nm Trama (ex: 6 ou 30/2): <input type="text" id="nmTramaLI" value="26"></label>
      <label>Encolhimento Teia (%): <input type="number" id="encTeiaLI" value="5"></label>
      <label>Encolhimento Trama (%): <input type="number" id="encTramaLI" value="5"></label>
      <label>Largura da Tela (cm): <input type="number" id="larguraLI" value="330"></label>
    </div>

    <label>Exportar:
      <select id="exportarTipo">
        <option value="ambos">Algod√£o e Linho</option>
        <option value="algodao">Somente Algod√£o</option>
        <option value="linho">Somente Linho</option>
      </select>
    </label>

    <button onclick="calcular()">Calcular</button>
    <button onclick="exportarPDF()">Exportar para PDF</button>

    <div class="result" id="resultado"></div>
  </div>

  <script>
    function mostrarCampos() {
      const tipo = document.getElementById("tipoCalculo").value;
      document.getElementById("algodaoCampos").style.display = (tipo === "linho") ? "none" : "block";
      document.getElementById("linhoCampos").style.display = (tipo === "algodao") ? "none" : "block";
    }
    window.onload = mostrarCampos;

    function corrigirTitulo(titulo) {
      if (titulo.includes("/")) {
        const partes = titulo.split("/");
        return parseFloat(partes[0]) / parseFloat(partes[1]);
      }
      return parseFloat(titulo);
    }

    let resultados = {};

    function calcular() {
      // Algod√£o
      const fiosTeiaCO = parseFloat(document.getElementById("fiosTeiaCO").value);
      const fiosTramaCO = parseFloat(document.getElementById("fiosTramaCO").value);
      const neTeiaCO = corrigirTitulo(document.getElementById("neTeiaCO").value);
      const neTramaCO = corrigirTitulo(document.getElementById("neTramaCO").value);
      const encTeiaCO = parseFloat(document.getElementById("encTeiaCO").value) / 100;
      const encTramaCO = parseFloat(document.getElementById("encTramaCO").value) / 100;
      const larguraCO = parseFloat(document.getElementById("larguraCO").value);

      const parteTeiaCO = ((fiosTeiaCO / 0.0254) + ((fiosTeiaCO / 0.0254) * encTeiaCO)) / (neTeiaCO / 0.59);
      const parteTramaCO = ((fiosTramaCO / 0.0254) + ((fiosTramaCO / 0.0254) * encTramaCO)) / (neTramaCO / 0.59);
      const gramagemCO = parteTeiaCO + parteTramaCO;
      const pesoLinearCO = gramagemCO * (larguraCO / 100);

      // Linho
      const fiosTeiaLI = parseFloat(document.getElementById("fiosTeiaLI").value);
      const fiosTramaLI = parseFloat(document.getElementById("fiosTramaLI").value);
      const nmTeiaLI = corrigirTitulo(document.getElementById("nmTeiaLI").value);
      const nmTramaLI = corrigirTitulo(document.getElementById("nmTramaLI").value);
      const encTeiaLI = parseFloat(document.getElementById("encTeiaLI").value) / 100;
      const encTramaLI = parseFloat(document.getElementById("encTramaLI").value) / 100;
      const larguraLI = parseFloat(document.getElementById("larguraLI").value);

      const parteTeiaLI = ((fiosTeiaLI / 0.0254) + ((fiosTeiaLI / 0.0254) * encTeiaLI)) / nmTeiaLI;
      const parteTramaLI = ((fiosTramaLI / 0.0254) + ((fiosTramaLI / 0.0254) * encTramaLI)) / nmTramaLI;
      const gramagemLI = parteTeiaLI + parteTramaLI;
      const pesoLinearLI = gramagemLI * (larguraLI / 100);

      resultados = {
        algodao: {
          gramagem: gramagemCO.toFixed(2),
          pesoLinear: pesoLinearCO.toFixed(2),
          fiosTeia: fiosTeiaCO,
          fiosTrama: fiosTramaCO,
          neTeia: neTeiaCO,
          neTrama: neTramaCO,
          encTeia: encTeiaCO * 100,
          encTrama: encTramaCO * 100,
          largura: larguraCO
        },
        linho: {
          gramagem: gramagemLI.toFixed(2),
		   pesoLinear: pesoLinearLI.toFixed(2),
          fiosTeia: fiosTeiaLI,
          fiosTrama: fiosTramaLI,
          nmTeia: nmTeiaLI,
          nmTrama: nmTramaLI,
          encTeia: encTeiaLI * 100,
          encTrama: encTramaLI * 100,
          largura: larguraLI
        }
      };

const tipoSelecionado = document.getElementById("tipoCalculo").value;
let resultadoTexto = "";

if (tipoSelecionado === "algodao" || tipoSelecionado === "ambos") {
  resultadoTexto += `Gramagem Algod√£o (CO): ${resultados.algodao.gramagem} g/m¬≤<br>`;
  resultadoTexto += `Peso Linear Algod√£o: ${resultados.algodao.pesoLinear} g/m<br><br>`;
}

if (tipoSelecionado === "linho" || tipoSelecionado === "ambos") {
  resultadoTexto += `Gramagem Linho (LI): ${resultados.linho.gramagem} g/m¬≤<br>`;
  resultadoTexto += `Peso Linear Linho: ${resultados.linho.pesoLinear} g/m`;
}

document.getElementById("resultado").innerHTML = resultadoTexto;
    }

    function exportarPDF() {
      const tipo = document.getElementById("exportarTipo").value;
      const nomeProjeto = document.getElementById("nomeProjeto").value.trim();
      const tituloProjeto = nomeProjeto !== "" ? nomeProjeto : "Projeto: C√°lculo de Gramagem e Peso Linear";

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(14);
      doc.text(tituloProjeto, 20, 20);

      const tabelas = [];

      if (tipo === "algodao" || tipo === "ambos") {
        tabelas.push({
          title: "Algod√£o (CO)",
          head: [["Fios Teia", "Fios Trama", "Ne Teia", "Ne Trama", "Enc. Teia (%)", "Enc. Trama (%)", "Largura (cm)", "Gramagem (g/m¬≤)", "Peso Linear (g/m)"]],
          body: [[
            resultados.algodao.fiosTeia,
            resultados.algodao.fiosTrama,
            resultados.algodao.neTeia,
            resultados.algodao.neTrama,
            resultados.algodao.encTeia,
            resultados.algodao.encTrama,
            resultados.algodao.largura,
            resultados.algodao.gramagem,
            resultados.algodao.pesoLinear
          ]]
        });
      }

      if (tipo === "linho" || tipo === "ambos") {
        tabelas.push({
          title: "Linho (LI)",
          head: [["Fios Teia", "Fios Trama", "Nm Teia", "Nm Trama", "Enc. Teia (%)", "Enc. Trama (%)", "Largura (cm)", "Gramagem (g/m¬≤)", "Peso Linear (g/m)"]],
          body: [[
            resultados.linho.fiosTeia,
            resultados.linho.fiosTrama,
            resultados.linho.nmTeia,
            resultados.linho.nmTrama,
            resultados.linho.encTeia,
            resultados.linho.encTrama,
            resultados.linho.largura,
            resultados.linho.gramagem,
            resultados.linho.pesoLinear
          ]]
        });
      }

      let y = 30;
      tabelas.forEach(tabela => {
        doc.text(tabela.title, 20, y);
        doc.autoTable({
          startY: y + 5,
          head: tabela.head,
          body: tabela.body,
          theme: 'grid',
          styles: { fontSize: 10 }
        });
        y = doc.lastAutoTable.finalY + 10;
      });

      doc.save("calculo_gramagem_peso_linear.pdf");
    }
  </script>
</body>
</html>

